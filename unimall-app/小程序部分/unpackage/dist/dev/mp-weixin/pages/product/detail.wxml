<view class="container"><view class="carousel"><swiper indicator-dots="{{true}}" circular="true" duration="400"><block wx:for="{{goods.imgList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><swiper-item class="swiper-item"><view class="image-wrapper"><image class="loaded" src="{{item+'/600px'}}" mode="aspectFit"></image></view></swiper-item></block></swiper></view><view class="introduce-section"><text class="title">{{goods.title}}</text><view class="price-box"><text class="price-tip">¥</text><text class="price">{{isVip?(selectedSku.vipPrice?selectedSku.vipPrice:goods.vipPrice)/100.0+' [VIP]':(selectedSku.price?selectedSku.price:goods.price)/100.0}}</text><block wx:if="{{(isVip?selectedSku.vipPrice?selectedSku.vipPrice:goods.vipPrice:selectedSku.price?selectedSku.price:goods.price)<(selectedSku.price?selectedSku.originalPrice:goods.originalPrice)}}"><text class="m-price">{{"¥"+(selectedSku.price?selectedSku.originalPrice:goods.originalPrice)/100}}</text></block><block wx:if="{{(isVip?selectedSku.vipPrice?selectedSku.vipPrice:goods.vipPrice:selectedSku.price?selectedSku.price:goods.price)<(selectedSku.price?selectedSku.originalPrice:goods.originalPrice)}}"><text class="coupon-tip">{{$root.m0/10+"折"}}</text></block></view><view class="bot-row"><text>{{"销量: "+(goods.sales||0)}}</text><text>{{"销售单位: "+(goods.unit||'')}}</text><text>{{"库存: "+(goods.stock||0)}}</text></view></view><block wx:if="{{goods.groupShop}}"><button class="share-section" open-type="share"><view class="share-icon"><text class="yticon icon-xingxing"></text>团</view><text class="tit">{{goods.groupShop.minimumNumber+"人成团，已有"+goods.groupShop.alreadyBuyNumber+"人参团"}}</text><text class="yticon icon-bangzhu1"></text><view class="share-btn">告诉TA<text class="yticon icon-you"></text></view></button></block><view class="c-list"><view data-event-opts="{{[['tap',[['toggleSpec',['$event']]]]]}}" class="c-row b-b" bindtap="__e"><text class="tit">购买类型</text><view class="con"><text class="selected-text">{{''+(selectedSku.title?selectedSku.title:'请选择')+''}}</text></view><text class="yticon icon-you"></text></view><block wx:if="{{couponList.length>0}}"><view data-event-opts="{{[['tap',[['toggleMask',['show']]]]]}}" class="c-row b-b" bindtap="__e"><text class="tit">优惠券</text><text class="con t-r red">领取优惠券</text><text class="yticon icon-you"></text></view></block><view data-event-opts="{{[['tap',[['createsShareImage',['$event']]]]]}}" class="c-row b-b" bindtap="__e"><text class="tit">推荐商品给好友</text><text class="con t-r red"></text><text class="yticon icon-you"></text></view><view class="c-row b-b"><text class="tit">配送费用</text><block wx:if="{{goods.freightTemplate}}"><view class="con-list"><text>{{"单笔购买满¥"+goods.freightTemplate.freightTemplateDO.defaultFreePrice/100.0+"元免邮费"}}</text><block wx:if="{{goods.freightTemplate.freightTemplateDO.defaultContinueMoney>0}}"><text>{{"每增加"+goods.freightTemplate.freightTemplateDO.defaultFirstNum+"件，增加运费¥"+goods.freightTemplate.freightTemplateDO.defaultContinueMoney/100.0+"元"}}</text></block><block wx:if="{{goods.freightTemplate.freightTemplateCarriageDOList.length>0}}"><text>TODO 特殊情况说明页面</text></block></view></block></view><block wx:for="{{goods.attributeList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="c-row b-b"><text class="tit">{{item.attribute}}</text><view class="bz-list con"><text>{{item.value}}</text></view></view></block></view><block wx:if="{{goods.appraisePage&&goods.appraisePage.items.length>0}}"><view class="eva-section"><view class="e-header"><text class="tit">评价</text><text>{{"("+goods.appraisePage.count+")"}}</text><text data-event-opts="{{[['tap',[['navAllAppraise',['$event']]]]]}}" class="tip" bindtap="__e">全部评论</text><text class="yticon icon-you"></text></view><view class="eva-box"><image class="portrait" src="{{goods.appraisePage.items[0].userAvatarUrl?goods.appraisePage.items[0].userAvatarUrl:'/static/missing-face.png'}}" mode="aspectFill"></image><view class="right"><text class="name">{{goods.appraisePage.items[0].userNickName?goods.appraisePage.items[0].userNickName:'用户'+goods.appraisePage.items[0].userId}}</text><text class="con">{{goods.appraisePage.items[0].content}}</text><view class="bot"><text class="attr">{{"购买类型："+goods.appraisePage.items[0].skuTitle}}</text><text class="time">{{goods.appraisePage.items[0].gmtCreate}}</text></view></view></view></view></block><view class="detail-desc"><view class="d-header"><text>图文详情</text></view><u-parse vue-id="778f76c8-1" className="rich-img" content="{{goods.detail}}" bind:__l="__l"></u-parse></view><view class="page-bottom"><navigator class="p-b-btn" url="/pages/index/index" open-type="switchTab"><text class="yticon icon-xiatubiao--copy"></text><text>首页</text></navigator><navigator class="p-b-btn" url="/pages/cart/cart" open-type="switchTab"><text class="yticon icon-gouwuche"></text><text>购物车</text></navigator><view data-event-opts="{{[['tap',[['toFavorite',['$event']]]]]}}" class="{{['p-b-btn',(goods.collect)?'active':'']}}" bindtap="__e"><text class="yticon icon-shoucang"></text><text>收藏</text></view><view class="action-btn-group"><button class=" action-btn no-border buy-now-btn" type="primary" data-event-opts="{{[['tap',[['buy',['$event']]]]]}}" bindtap="__e">{{goods.groupShop?'立即参团':'立即购买'}}</button><button class=" action-btn no-border add-cart-btn" type="primary" data-event-opts="{{[['tap',[['addCart',['$event']]]]]}}" bindtap="__e">加入购物车</button></view></view><view data-event-opts="{{[['tap',[['toggleMask',['$event']]]]]}}" class="{{['mask',maskState===0?'none':maskState===1?'show':'']}}" bindtap="__e"><view data-event-opts="{{[['tap',[['stopPrevent',['$event']]]]]}}" class="mask-content" catchtap="__e"><block wx:for="{{couponList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['obtainCoupon',[index]]]]]}}" class="coupon-item" bindtap="__e"><view class="con"><view class="left"><text class="title">{{item.title}}</text><block wx:if="{{item.gmtEnd}}"><text class="time">{{"在"+item.gmtEnd+"前有效。 可领"+item.limit+"张，已领"+item.nowCount+"张"}}</text></block><block wx:if="{{!item.gmtEnd}}"><text class="time">{{"在领取后"+item.days+"天内有效。可领"+item.limit+"张，已领"+item.nowCount+"张"}}</text></block></view><view class="right"><text class="price">{{item.discount/100.0}}</text><text>{{"满"+item.min/100.0+"可用"}}</text></view><view class="circle l"></view><view class="circle r"></view></view><text class="tips">{{item.categoryTitle?'限'+item.categoryTitle+'可用':'全品类可用'}}</text></view></block></view></view><view data-event-opts="{{[['touchmove',[['stopPrevent',['$event']]]]]}}" class="{{['popup','spec',specClass]}}" catchtouchmove="__e"><view data-event-opts="{{[['tap',[['hideSpec',['$event']]]]]}}" class="mask" catchtap="__e"></view><view data-event-opts="{{[['tap',[['stopPrevent',['$event']]]]]}}" class="layer attr-content" catchtap="__e"><view class="a-t"><block wx:if="{{goods.img}}"><image src="{{(selectedSku.img?selectedSku.img:goods.img)+'/200px'}}"></image></block><view class="right"><text class="price">{{"¥ "+(isVip?selectedSku.vipPrice*goodsNum/100.0+' [VIP]':selectedSku.price*goodsNum/100.0)}}</text><text class="stock">{{"库存："+selectedSku.stock+"件"}}</text><view class="selected">已选：<text>{{''+selectedSku.title+''}}</text></view></view></view><view class="attr-list"><view class="item-list"><block wx:for="{{goods.skuList}}" wx:for-item="skuItem" wx:for-index="skuIndex" wx:key="skuIndex"><text data-event-opts="{{[['tap',[['selectSpec',['$0',skuIndex],[[['goods.skuList','',skuIndex]]]]]]]}}" class="{{['tit',(skuIndex===selectedSkuIndex)?'selected':'']}}" bindtap="__e">{{''+skuItem.title+''}}</text></block></view></view><view data-event-opts="{{[['tap',[['numSub',['$event']]]]]}}" class="sub" bindtap="__e">-</view><view class="num">{{goodsNum}}</view><view data-event-opts="{{[['tap',[['numAdd',['$event']]]]]}}" class="add" bindtap="__e">+</view><button data-event-opts="{{[['tap',[['toggleSpec',['$event']]]]]}}" class="btn" bindtap="__e">完成</button></view></view><share-images class="vue-ref" style="width:0;height:0;opacity:0;" vue-id="778f76c8-2" canvasWidth="{{canvasWidth}}" canvasHeight="{{canvasHeight}}" shareTitle="{{shareTitle}}" goodsTitle="{{goodsTitle}}" goodsPrice="{{goodsPrice}}" goodsOriginalPrice="{{goodsOriginalPrice}}" shareImage="{{shareImageUrl}}" qrSize="{{qrSize}}" qrUrl="{{qrUrl}}" data-ref="canvas" data-event-opts="{{[['^success',[['shareSuccess']]]]}}" bind:success="__e" bind:__l="__l"></share-images></view>