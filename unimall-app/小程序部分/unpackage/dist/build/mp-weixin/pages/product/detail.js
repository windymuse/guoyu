(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/detail"],{"44ca":function(e,o,t){"use strict";t.r(o);var s=t("47f5"),i=t.n(s);for(var n in s)"default"!==n&&function(e){t.d(o,e,(function(){return s[e]}))}(n);o["default"]=i.a},"47f5":function(e,o,t){"use strict";(function(e){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s,i=n(t("a34a"));function n(e){return e&&e.__esModule?e:{default:e}}function a(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function c(e,o,t,s,i,n,a){try{var c=e[n](a),r=c.value}catch(u){return void t(u)}c.done?o(r):Promise.resolve(r).then(s,i)}function r(e){return function(){var o=this,t=arguments;return new Promise((function(s,i){var n=e.apply(o,t);function a(e){c(n,s,i,a,r,"next",e)}function r(e){c(n,s,i,a,r,"throw",e)}a(void 0)}))}}var u=function(){Promise.all([t.e("common/vendor"),t.e("components/gaoyia-parse/parse")]).then(function(){return resolve(t("8b55"))}.bind(null,t)).catch(t.oe)},d=function(){t.e("components/hj-placard/shareImages").then(function(){return resolve(t("a03a"))}.bind(null,t)).catch(t.oe)},l=(s={components:{uParse:u,shareImages:d},data:function(){return{goods:{freightTemplate:void 0,skuList:[],categoryList:[],appraisePage:void 0},isVip:!1,specClass:"none",specSelected:[],selectedSku:{},selectedSkuIndex:-1,toggleCallback:void 0,maskState:0,couponList:[],submiting:!1,goodsNum:1,canvasImages:"",canvasWidth:375,canvasHeight:650,shareTitle:"限时秒杀",goodsTitle:"商品标题",goodsPrice:0,goodsOriginalPrice:0,shareImage:"",qrSize:100,qrUrl:"",shareImageUrl:""}},onShow:function(){this.isVip=this.$api.isVip()},onLoad:function(o){var t=this;return r(i.default.mark((function s(){var n,a,c,r,u;return i.default.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return console.log("onLoad",o),n=o.id,a=o.gid,null!=o.scene&&(console.log("start scene process"),c=decodeURIComponent(o.scene),r=c.split("&"),n=r[0],r.length>1&&(a=r[1])),console.log("id",n),console.log("gid",a),u=t,e.showLoading({title:"正在加载"}),s.next=10,u.getQRCode(n,a);case 10:u.$api.request("goods","getGoods",{spuId:n,groupShopId:a||""},(function(o){u.$api.msg(o.errmsg),e.hideLoading()})).then((function(o){if(u.goods=o.data,u.goods.groupShop){u.goods.price=u.goods.groupShop.minPrice,u.goods.vipPrice=u.goods.groupShop.minPrice;for(var t=0;t<u.goods.skuList.length;t++)for(var s=0;s<u.goods.groupShop.groupShopSkuList.length;s++)u.goods.skuList[t].id===u.goods.groupShop.groupShopSkuList[s].skuId&&(u.goods.skuList[t].price=u.goods.groupShop.groupShopSkuList[s].skuGroupShopPrice,u.goods.skuList[t].vipPrice=u.goods.groupShop.groupShopSkuList[s].skuGroupShopPrice)}e.hideLoading()})),u.$api.request("coupon","getObtainableCoupon").then((function(e){u.couponList=e.data}));case 12:case"end":return s.stop()}}),s)})))()},onShareAppMessage:function(){return{title:(this.goods.groupShop?"立即拼团-":"好货分享-")+this.goods.title,imageUrl:"https://easycampus-asset.oss-cn-shenzhen.aliyuncs.com/sharebg.png",path:"/pages/product/detail?id="+this.goods.id+(this.goods.groupShop?"&gid="+this.goods.groupShop.id:"")}}},a(s,"onShareAppMessage",(function(){return{title:"国渔鲜生小程序",desc:"全球鲜生供应商",path:"/pages/index/index"}})),a(s,"onShareTimeline",(function(){return{}})),a(s,"methods",{getQRCode:function(e,o){var t=this;return r(i.default.mark((function s(){var n;return i.default.wrap((function(s){while(1)switch(s.prev=s.next){case 0:n=t,n.$api.request("goods","getQRCode",{spuId:e,groupShopId:o||""},(function(e){n.$api.msg(e.errmsg)})).then((function(e){console.log(e),e.data&&(n.qrUrl=e.data.url,console.log(n.qrUrl))}));case 2:case"end":return s.stop()}}),s)})))()},createsShareImage:function(){var e=this;return r(i.default.mark((function o(){var t;return i.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e.goodsTitle=e.goods.title,e.goodsPrice=e.goods.price,e.goodsOriginalPrice=e.goods.originalPrice,t=e.goods.imgList[0]+"/600px",e.shareImageUrl=t,console.log(t,e.shareImageUrl),e.$forceUpdate(),setTimeout(r(i.default.mark((function o(){return i.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(!(e.canvasImages&&e.canvasImages.length>0)){o.next=4;break}e.previewHandle(),o.next=7;break;case 4:return o.next=6,e.$refs.canvas.canvasCreate();case 6:e.previewHandle();case 7:case"end":return o.stop()}}),o)}))),100);case 8:case"end":return o.stop()}}),o)})))()},previewHandle:function(){e.previewImage({urls:[this.canvasImages]})},shareSuccess:function(e){this.canvasImages=e},onShareAppMessage:function(e){return{title:"canvas图片分享",path:this.canvasImages}},numSub:function(){this.goodsNum>1&&this.goodsNum--},numAdd:function(){this.goodsNum++},toggleMask:function(e){var o=this,t="show"===e?10:300,s="show"===e?1:0;this.maskState=2,setTimeout((function(){o.maskState=s}),t)},obtainCoupon:function(e){var o=this;o.$api.request("coupon","obtainCoupon",{couponId:o.couponList[e].id}).then((function(t){o.$api.msg("领取成功"),o.couponList[e].nowCount++,o.toggleMask()}))},toggleSpec:function(e){var o=this;"show"===this.specClass?(this.specClass="hide",setTimeout((function(){o.specClass="none",o.toggleCallback&&(o.toggleCallback(),o.toggleCallback=void 0)}),150)):"none"===this.specClass&&(this.specClass="show",this.selectedSku.title||(this.selectedSku=this.goods.skuList[0],this.selectedSkuIndex=0))},selectSpec:function(e,o){this.selectedSku=e,this.selectedSkuIndex=o},addCart:function(e){var o=this;o.selectedSku.id?o.$api.request("cart","addCartItem",{skuId:o.selectedSku.id,num:o.goodsNum}).then((function(e){o.$api.msg("添加购物车成功"),o.specClass="none",o.selectedSku={},o.toggleCallback=void 0})):(o.specClass="none",o.toggleSpec(),o.toggleCallback=o.addCart)},toFavorite:function(){var e=this;e.goods.collect?(e.goods.collect=!1,this.$api.request("collect","deleteCollect",{spuId:e.goods.id}).then((function(e){}))):(e.goods.collect=!0,this.$api.request("collect","addCollect",{spuId:e.goods.id}))},buy:function(){var o=this;if(o.selectedSku.id){var t={skuId:o.selectedSku.id,num:o.goodsNum,title:o.goods.title,originalPrice:o.selectedSku.originalPrice,price:o.selectedSku.price,vipPrice:o.selectedSku.vipPrice,skuTitle:o.selectedSku.title,spuImg:o.goods.img,skuImg:o.selectedSku.img,stock:o.selectedSku.stock,spuId:o.goods.id,categoryId:o.goods.categoryId,categoryIdList:o.goods.categoryIds};o.goods.groupShop&&(t["groupShopId"]=o.goods.groupShop.id);var s=[1];s[0]=t,o.$api.globalData.skuList=s,e.navigateTo({url:"/pages/order/create?takeway=buy"}),o.specClass="none",o.selectedSku={},o.toggleCallback=void 0}else o.specClass="none",o.toggleSpec(),o.toggleCallback=o.buy},navAllAppraise:function(){e.navigateTo({url:"/pages/product/appraise?spuid=".concat(this.goods.id,"&firstpage=").concat(JSON.stringify(this.goods.appraisePage))})},stopPrevent:function(){}}),s);o.default=l}).call(this,t("543d")["default"])},"609b":function(e,o,t){"use strict";var s=t("877b"),i=t.n(s);i.a},"79cd":function(e,o,t){"use strict";t.r(o);var s=t("dce5"),i=t("44ca");for(var n in i)"default"!==n&&function(e){t.d(o,e,(function(){return i[e]}))}(n);t("609b");var a,c=t("f0c5"),r=Object(c["a"])(i["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],a);o["default"]=r.exports},"877b":function(e,o,t){},b2fc:function(e,o,t){"use strict";(function(e){t("f494");s(t("66fd"));var o=s(t("79cd"));function s(e){return e&&e.__esModule?e:{default:e}}e(o.default)}).call(this,t("543d")["createPage"])},dce5:function(e,o,t){"use strict";var s;t.d(o,"b",(function(){return i})),t.d(o,"c",(function(){return n})),t.d(o,"a",(function(){return s}));var i=function(){var e=this,o=e.$createElement,t=(e._self._c,(e.isVip?e.selectedSku.vipPrice?e.selectedSku.vipPrice:e.goods.vipPrice:e.selectedSku.price?e.selectedSku.price:e.goods.price)<(e.selectedSku.price?e.selectedSku.originalPrice:e.goods.originalPrice)?parseInt((e.isVip?e.selectedSku.vipPrice?e.selectedSku.vipPrice:e.goods.vipPrice:e.selectedSku.price?e.selectedSku.price:e.goods.price)/(e.selectedSku.originalPrice?e.selectedSku.originalPrice:e.goods.originalPrice)*100):null);e.$mp.data=Object.assign({},{$root:{m0:t}})},n=[]}},[["b2fc","common/runtime","common/vendor"]]]);