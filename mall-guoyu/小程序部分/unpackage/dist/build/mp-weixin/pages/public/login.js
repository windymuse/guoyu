(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/public/login"],{"66d0":function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(t("a34a")),i=t("26cb");function r(e){return e&&e.__esModule?e:{default:e}}function o(e,n,t,a,i,r,o){try{var c=e[r](o),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(a,i)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(a,i){var r=e.apply(n,t);function c(e){o(r,a,i,c,u,"next",e)}function u(e){o(r,a,i,c,u,"throw",e)}c(void 0)}))}}function u(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?u(Object(t),!0).forEach((function(n){f(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function f(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var d={data:function(){return{loginType:"wechat",phone:"",password:"",logining:!1,merchantConfig:{}}},onShow:function(){this.$api.logout()},onLoad:function(e){var n=this;n.$api.request("config","getMerchantConfig",{},(function(e){n.$api.msg(e.errmsg)})).then((function(e){console.log("商户信息",e.data),n.merchantConfig=e.data}))},onShareAppMessage:function(){return{title:"国渔鲜生小程序",desc:"全球鲜生供应商",path:"/pages/index/index"}},onShareTimeline:function(){return{}},methods:s(s({},(0,i.mapMutations)(["login"])),{},{inputChange:function(e){var n=e.currentTarget.dataset.key;this[n]=e.detail.value},chooseLoginType:function(e){this.loginType=e},navBack:function(){e.navigateBack()},toRegist:function(){e.redirectTo({url:"/pages/public/register"})},toLogin:function(){var n=this;return c(a.default.mark((function t(){var i;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:i=n,11!==i.phone.length?i.$api.msg("请输入11位中国手机号"):i.password.length<8?i.$api.msg("密码至少8位"):(i.logining=!0,e.login({provider:"weixin",success:function(n){i.$api.request("user","login",{phone:i.phone,password:i.password,loginType:1,raw:JSON.stringify(n)},(function(n){i.logining=!1,e.showToast({title:n.errmsg,icon:"none"})})).then((function(n){i.logining=!1,i.$store.commit("login",n.data),e.setStorageSync("userInfo",n.data),i.$api.prePage().lodaData&&i.$api.prePage().loadData(),e.navigateBack()}))}}));case 2:case"end":return t.stop()}}),t)})))()},miniWechatLogin:function(n){var t=this;t.logining=!0;var a=1,i=n.detail.userInfo;e.login({provider:"weixin",success:function(n){t.logining=!1,t.$api.request("user","thirdPartLogin",{loginType:a,raw:JSON.stringify(n)},(function(n){t.$api.msg(n.errmsg),e.hideLoading()})).then((function(n){t.$api.setUserInfo(n.data),t.$api.request("user","syncUserInfo",i).then((function(a){n.data.nickname=i.nickName,n.data.avatarUrl=i.avatarUrl,n.data.gender=i.gender,e.setStorageSync("userInfo",n.data),t.$store.commit("login",n.data),t.$api.setUserInfo(n.data),t.$api.prePage().lodaData&&t.$api.prePage().loadData(),e.hideLoading(),e.navigateBack()}))}))}})},wechatLogin:function(){var n=this;n.logining=!0;var t=2;e.showLoading({title:"正在同步消息"}),e.login({provider:"weixin",success:function(a){n.$api.request("user","thirdPartLogin",{loginType:t,raw:JSON.stringify(a)},(function(t){n.$api.msg(t.errmsg),e.hideLoading()})).then((function(t){n.logining=!1,e.getUserInfo({lang:"zh_CN",success:function(a){e.setStorageSync("userInfo",t.data),n.$store.commit("login",t.data),a.userInfo.nickname=a.userInfo.nickName,n.$api.request("user","syncUserInfo",a.userInfo).then((function(i){t.data.nickname=a.userInfo.nickName,t.data.avatarUrl=a.userInfo.avatarUrl,t.data.gender=a.userInfo.gender,e.setStorageSync("userInfo",t.data),n.$store.commit("login",t.data)}))},complete:function(t){n.$api.prePage().lodaData&&n.$api.prePage().loadData(),e.hideLoading(),e.navigateBack()}})}))}})},wechatH5Login:function(){var e=this,n=window.location.origin,t=e.$api.prePage(),a="/pages/index/index";t&&(a=t.__page__.path),window.location="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+e.$api.defConfig().h5Appid+"&redirect_uri="+escape(n)+"&response_type=code&scope=snsapi_userinfo&state="+escape(a)+"#wechat_redirect"}})};n.default=d}).call(this,t("543d")["default"])},"8b4d":function(e,n,t){"use strict";t.r(n);var a=t("66d0"),i=t.n(a);for(var r in a)"default"!==r&&function(e){t.d(n,e,(function(){return a[e]}))}(r);n["default"]=i.a},"9e50":function(e,n,t){},aa1c:function(e,n,t){"use strict";var a=t("9e50"),i=t.n(a);i.a},b16e:function(e,n,t){"use strict";(function(e){t("f494");a(t("66fd"));var n=a(t("bd06"));function a(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},bd06:function(e,n,t){"use strict";t.r(n);var a=t("cd4e"),i=t("8b4d");for(var r in i)"default"!==r&&function(e){t.d(n,e,(function(){return i[e]}))}(r);t("aa1c");var o,c=t("f0c5"),u=Object(c["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],o);n["default"]=u.exports},cd4e:function(e,n,t){"use strict";var a;t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return a}));var i=function(){var e=this,n=e.$createElement;e._self._c},r=[]}},[["b16e","common/runtime","common/vendor"]]]);